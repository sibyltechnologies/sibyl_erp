<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sibyl Admin Portal</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Geist:wght@300;400;500;600;700;800&family=Geist+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
:root{
    --bg:         #080A12;
    --bg2:        #0D1020;
    --bg3:        #131729;
    --border:     rgba(255,255,255,0.07);
    --border2:    rgba(255,255,255,0.12);
    --text:       #E2E5F0;
    --text2:      #7B84A8;
    --text3:      #3D4466;
    --accent:     #5B6AF0;
    --accent2:    #4755D4;
    --accent-g:   rgba(91,106,240,0.15);
    --accent-glow:rgba(91,106,240,0.3);
    --green:      #10B981;
    --red:        #F0564A;
    --yellow:     #F59E0B;
    --purple:     #8B5CF6;
    --cyan:       #06B6D4;
    --font:       'Geist', sans-serif;
    --mono:       'Geist Mono', monospace;
    --r:          10px;
    --nav-w:      240px;
}
html,body{height:100%;font-family:var(--font);background:var(--bg);color:var(--text);font-size:13px;-webkit-font-smoothing:antialiased;}

/* â”€â”€ LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.app{display:grid;grid-template-columns:var(--nav-w) 1fr;height:100vh;}

/* â”€â”€ SIDEBAR NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidenav{
    background:var(--bg2);
    border-right:1px solid var(--border);
    display:flex;flex-direction:column;
    overflow-y:auto;
    position:sticky;top:0;height:100vh;
}
.sidenav-brand{
    padding:20px 18px 16px;
    border-bottom:1px solid var(--border);
    display:flex;align-items:center;gap:10px;
}
.brand-mark{
    width:32px;height:32px;
    background:linear-gradient(135deg,var(--accent),#8B5CF6);
    border-radius:9px;
    display:flex;align-items:center;justify-content:center;
    font-size:15px;font-weight:800;color:#fff;
    flex-shrink:0;
    box-shadow:0 4px 14px var(--accent-glow);
}
.brand-info{flex:1;}
.brand-name{font-size:14px;font-weight:700;letter-spacing:-0.02em;color:var(--text);}
.brand-sub{font-size:10px;color:var(--text3);font-weight:500;letter-spacing:0.04em;text-transform:uppercase;}

.nav-section{padding:12px 10px 0;}
.nav-label{font-size:9.5px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:0.1em;padding:6px 8px 4px;}
.nav-item{
    display:flex;align-items:center;gap:10px;
    padding:8px 10px;border-radius:7px;
    color:var(--text2);font-size:12.5px;font-weight:500;
    cursor:pointer;transition:all 0.15s;
    border:1px solid transparent;margin-bottom:1px;
}
.nav-item:hover{background:rgba(255,255,255,0.05);color:var(--text);}
.nav-item.active{background:var(--accent-g);border-color:rgba(91,106,240,0.25);color:var(--accent);}
.nav-icon{width:16px;text-align:center;font-size:14px;flex-shrink:0;}
.nav-badge{margin-left:auto;background:var(--accent);color:#fff;font-size:9px;font-weight:700;padding:1px 6px;border-radius:99px;}

.sidenav-bottom{margin-top:auto;padding:12px 10px;border-top:1px solid var(--border);}
.user-row{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:8px;cursor:pointer;}
.user-row:hover{background:rgba(255,255,255,0.04);}
.user-avatar{width:28px;height:28px;border-radius:50%;background:var(--accent);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff;flex-shrink:0;}
.user-name{font-size:12px;font-weight:600;color:var(--text);}
.user-role{font-size:10px;color:var(--text3);}

/* â”€â”€ MAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main{overflow-y:auto;display:flex;flex-direction:column;}

.topbar{
    height:52px;
    background:var(--bg2);
    border-bottom:1px solid var(--border);
    display:flex;align-items:center;
    padding:0 24px;gap:12px;
    position:sticky;top:0;z-index:50;
    flex-shrink:0;
}
.topbar-title{font-size:15px;font-weight:700;letter-spacing:-0.01em;color:var(--text);}
.topbar-actions{margin-left:auto;display:flex;gap:8px;}

/* â”€â”€ PAGE CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.page{display:none;padding:28px;flex:1;animation:fadein 0.15s ease;}
.page.active{display:block;}
@keyframes fadein{from{opacity:0;transform:translateY(4px);}to{opacity:1;transform:translateY(0);}}

/* â”€â”€ STATS ROW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:24px;}
.stat-card{
    background:var(--bg2);border:1px solid var(--border);
    border-radius:var(--r);padding:18px;
    transition:border-color 0.15s;
}
.stat-card:hover{border-color:var(--border2);}
.stat-num{font-size:28px;font-weight:800;letter-spacing:-0.03em;color:var(--text);}
.stat-label{font-size:11px;color:var(--text2);font-weight:500;margin-top:4px;text-transform:uppercase;letter-spacing:0.06em;}
.stat-trend{font-size:11px;font-weight:600;margin-top:8px;}
.stat-trend.up{color:var(--green);}
.stat-trend.down{color:var(--red);}

/* â”€â”€ SECTION HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;}
.section-title{font-size:15px;font-weight:700;letter-spacing:-0.01em;}
.section-desc{font-size:12px;color:var(--text2);margin-top:2px;}

/* â”€â”€ TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.data-table{
    background:var(--bg2);border:1px solid var(--border);
    border-radius:var(--r);overflow:hidden;width:100%;
}
.data-table table{width:100%;border-collapse:collapse;}
.data-table th{
    padding:10px 16px;
    background:rgba(255,255,255,0.02);
    font-size:10px;font-weight:700;
    color:var(--text3);text-transform:uppercase;letter-spacing:0.08em;
    text-align:left;border-bottom:1px solid var(--border);
}
.data-table td{
    padding:12px 16px;
    font-size:12.5px;color:var(--text);
    border-bottom:1px solid var(--border);
    vertical-align:middle;
}
.data-table tr:last-child td{border-bottom:none;}
.data-table tr:hover td{background:rgba(255,255,255,0.025);}
.data-table td .row-actions{display:none;gap:6px;}
.data-table tr:hover td .row-actions{display:flex;}

/* â”€â”€ BADGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.badge{display:inline-flex;align-items:center;gap:4px;font-size:10px;font-weight:700;padding:3px 8px;border-radius:99px;text-transform:uppercase;letter-spacing:0.05em;}
.badge-green{background:rgba(16,185,129,0.12);color:var(--green);}
.badge-blue{background:var(--accent-g);color:var(--accent);}
.badge-red{background:rgba(240,86,74,0.12);color:var(--red);}
.badge-yellow{background:rgba(245,158,11,0.12);color:var(--yellow);}
.badge-purple{background:rgba(139,92,246,0.12);color:var(--purple);}
.badge-gray{background:rgba(255,255,255,0.07);color:var(--text2);}

/* â”€â”€ BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn{font-family:var(--font);font-size:12px;font-weight:600;padding:6px 14px;border-radius:7px;border:none;cursor:pointer;display:inline-flex;align-items:center;gap:6px;transition:all 0.15s;white-space:nowrap;}
.btn-primary{background:var(--accent);color:#fff;}
.btn-primary:hover{background:var(--accent2);transform:translateY(-1px);box-shadow:0 4px 14px var(--accent-glow);}
.btn-ghost{background:rgba(255,255,255,0.06);color:var(--text2);border:1px solid var(--border);}
.btn-ghost:hover{background:rgba(255,255,255,0.1);color:var(--text);}
.btn-danger{background:rgba(240,86,74,0.15);color:var(--red);}
.btn-danger:hover{background:rgba(240,86,74,0.25);}
.btn-sm{padding:4px 10px;font-size:11px;border-radius:5px;}

/* â”€â”€ THEME GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.theme-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px;}
.theme-card{
    background:var(--bg2);border:1.5px solid var(--border);
    border-radius:12px;overflow:hidden;
    cursor:pointer;transition:all 0.2s;
    position:relative;
}
.theme-card:hover{border-color:var(--border2);transform:translateY(-2px);box-shadow:0 8px 32px rgba(0,0,0,0.3);}
.theme-card.default{border-color:var(--accent);box-shadow:0 0 0 1px var(--accent);}
.theme-card.default::before{
    content:'Default';position:absolute;top:10px;right:10px;
    background:var(--accent);color:#fff;font-size:9px;font-weight:700;
    padding:2px 7px;border-radius:99px;text-transform:uppercase;letter-spacing:0.05em;
}

.theme-preview-bar{height:6px;display:flex;}
.theme-preview-bar span{flex:1;}

.theme-card-body{padding:14px;}
.theme-name{font-size:13px;font-weight:700;color:var(--text);letter-spacing:-0.01em;}
.theme-meta{font-size:11px;color:var(--text2);margin-top:3px;}
.theme-swatches{display:flex;gap:5px;margin-top:10px;}
.theme-swatch{width:20px;height:20px;border-radius:5px;border:1px solid rgba(255,255,255,0.1);}
.theme-card-footer{
    padding:10px 14px;border-top:1px solid var(--border);
    display:flex;gap:6px;
}

/* â”€â”€ CLIENT GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.client-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px;}
.client-card{
    background:var(--bg2);border:1px solid var(--border);
    border-radius:12px;padding:18px;
    transition:all 0.15s;
}
.client-card:hover{border-color:var(--border2);}
.client-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:12px;}
.client-initial{
    width:36px;height:36px;border-radius:9px;
    display:flex;align-items:center;justify-content:center;
    font-size:14px;font-weight:800;color:#fff;flex-shrink:0;
}
.client-name{font-size:14px;font-weight:700;color:var(--text);letter-spacing:-0.01em;}
.client-domain{font-size:11px;color:var(--text2);margin-top:2px;}
.client-stats{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:12px;}
.client-stat-item{background:rgba(255,255,255,0.03);border-radius:7px;padding:8px 10px;}
.client-stat-val{font-size:16px;font-weight:700;color:var(--text);}
.client-stat-lbl{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:0.06em;margin-top:2px;}
.client-footer{margin-top:14px;display:flex;gap:6px;}

/* â”€â”€ THEME ASSIGNMENT MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal-overlay{
    display:none;position:fixed;inset:0;
    background:rgba(0,0,0,0.7);backdrop-filter:blur(6px);
    z-index:200;align-items:center;justify-content:center;
}
.modal-overlay.open{display:flex;}
.modal{
    background:var(--bg3);border:1px solid var(--border2);
    border-radius:16px;width:480px;max-height:80vh;
    display:flex;flex-direction:column;
    box-shadow:0 24px 80px rgba(0,0,0,0.5);
    animation:modal-in 0.2s cubic-bezier(0.4,0,0.2,1);
}
@keyframes modal-in{from{opacity:0;transform:scale(0.96) translateY(8px);}to{opacity:1;transform:scale(1) translateY(0);}}
.modal-header{padding:20px 24px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.modal-title{font-size:16px;font-weight:700;letter-spacing:-0.01em;}
.modal-close{width:28px;height:28px;border-radius:6px;background:rgba(255,255,255,0.06);border:none;color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;transition:all 0.15s;}
.modal-close:hover{background:rgba(255,255,255,0.12);color:var(--text);}
.modal-body{padding:20px 24px;overflow-y:auto;flex:1;}
.modal-footer{padding:16px 24px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:8px;}

.theme-option{
    display:flex;align-items:center;gap:12px;
    padding:10px 12px;border-radius:8px;
    border:1.5px solid var(--border);
    cursor:pointer;transition:all 0.15s;margin-bottom:8px;
}
.theme-option:hover{border-color:var(--border2);background:rgba(255,255,255,0.03);}
.theme-option.selected{border-color:var(--accent);background:var(--accent-g);}
.theme-option-swatch{width:36px;height:36px;border-radius:8px;flex-shrink:0;}
.theme-option-info{flex:1;}
.theme-option-name{font-size:13px;font-weight:600;color:var(--text);}
.theme-option-meta{font-size:11px;color:var(--text2);}
.theme-option-check{width:18px;height:18px;border-radius:50%;border:2px solid var(--border2);display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.theme-option.selected .theme-option-check{background:var(--accent);border-color:var(--accent);color:#fff;font-size:10px;}

/* â”€â”€ SCROLLBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,0.1) transparent;}
*::-webkit-scrollbar{width:5px;}
*::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.1);border-radius:99px;}
</style>
</head>
<body>
<div class="app">

<!-- â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<nav class="sidenav">
    <div class="sidenav-brand">
        <div class="brand-mark">S</div>
        <div class="brand-info">
            <div class="brand-name">Sibyl Admin</div>
            <div class="brand-sub">v1.0.0</div>
        </div>
    </div>

    <div class="nav-section">
        <div class="nav-label">Overview</div>
        <div class="nav-item active" onclick="showPage('dashboard',this)">
            <span class="nav-icon">â¬›</span> Dashboard
        </div>
    </div>

    <div class="nav-section">
        <div class="nav-label">Clients</div>
        <div class="nav-item" onclick="showPage('clients',this)">
            <span class="nav-icon">ğŸ¢</span> All Clients
            <span class="nav-badge" id="clientCount">0</span>
        </div>
        <div class="nav-item" onclick="showPage('add-client',this)">
            <span class="nav-icon">ï¼‹</span> Add Client
        </div>
    </div>

    <div class="nav-section">
        <div class="nav-label">Themes</div>
        <div class="nav-item" onclick="showPage('themes',this)">
            <span class="nav-icon">ğŸ¨</span> All Themes
        </div>
        <div class="nav-item" onclick="openThemeBuilder()">
            <span class="nav-icon">âœï¸</span> Theme Builder â†—
        </div>
    </div>

    <div class="nav-section">
        <div class="nav-label">System</div>
        <div class="nav-item" onclick="showPage('modules',this)">
            <span class="nav-icon">ğŸ—‚ï¸</span> Module Access
        </div>
        <div class="nav-item" onclick="showPage('settings',this)">
            <span class="nav-icon">âš™ï¸</span> Settings
        </div>
    </div>

    <div class="sidenav-bottom">
        <div class="user-row">
            <div class="user-avatar">SA</div>
            <div>
                <div class="user-name">Sibyl Admin</div>
                <div class="user-role">System Manager</div>
            </div>
        </div>
    </div>
</nav>

<!-- â”€â”€ MAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="main">

    <div class="topbar">
        <span class="topbar-title" id="topbarTitle">Dashboard</span>
        <div class="topbar-actions" id="topbarActions"></div>
    </div>

    <!-- Dashboard -->
    <div class="page active" id="page-dashboard">
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-num" id="stat-clients">24</div>
                <div class="stat-label">Active Clients</div>
                <div class="stat-trend up">â†‘ 3 this month</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="stat-themes">7</div>
                <div class="stat-label">Themes</div>
                <div class="stat-trend up">â†‘ 2 new</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="stat-users">148</div>
                <div class="stat-label">Total Users</div>
                <div class="stat-trend up">â†‘ 12 this month</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="stat-enterprise">6</div>
                <div class="stat-label">Enterprise Plans</div>
                <div class="stat-trend up">â†‘ 1 upgraded</div>
            </div>
        </div>

        <div class="section-header">
            <div>
                <div class="section-title">Recent Clients</div>
                <div class="section-desc">Latest added or modified clients</div>
            </div>
            <button class="btn btn-primary" onclick="showPage('add-client',null)">+ Add Client</button>
        </div>

        <div class="data-table">
            <table>
                <thead>
                    <tr>
                        <th>Client</th>
                        <th>Status</th>
                        <th>Plan</th>
                        <th>Active Theme</th>
                        <th>Users</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="recentClientsBody">
                </tbody>
            </table>
        </div>
    </div>

    <!-- Clients -->
    <div class="page" id="page-clients">
        <div class="section-header">
            <div>
                <div class="section-title">All Clients</div>
                <div class="section-desc">Manage per-client theme and module access</div>
            </div>
            <button class="btn btn-primary" onclick="showPage('add-client',null)">+ Add Client</button>
        </div>
        <div class="client-grid" id="clientGrid"></div>
    </div>

    <!-- Themes -->
    <div class="page" id="page-themes">
        <div class="section-header">
            <div>
                <div class="section-title">Theme Library</div>
                <div class="section-desc">All themes â€” assign globally or per client</div>
            </div>
            <button class="btn btn-primary" onclick="openThemeBuilder()">+ Create Theme â†—</button>
        </div>
        <div class="theme-grid" id="themeGrid"></div>
    </div>

    <!-- Modules -->
    <div class="page" id="page-modules">
        <div class="section-header">
            <div>
                <div class="section-title">Module Access Control</div>
                <div class="section-desc">Control which ERP modules each client can access</div>
            </div>
        </div>
        <div class="data-table">
            <table>
                <thead>
                    <tr>
                        <th>Client</th>
                        <th>Accounts</th>
                        <th>Selling</th>
                        <th>Buying</th>
                        <th>Stock</th>
                        <th>CRM</th>
                        <th>HR</th>
                        <th>Projects</th>
                        <th>Manufacturing</th>
                    </tr>
                </thead>
                <tbody id="moduleAccessBody"></tbody>
            </table>
        </div>
    </div>

    <!-- Add Client -->
    <div class="page" id="page-add-client">
        <div class="section-header">
            <div><div class="section-title">Add New Client</div></div>
            <button class="btn btn-ghost" onclick="showPage('clients',null)">â† Back</button>
        </div>
        <div style="max-width:560px;">
            <div class="data-table" style="overflow:visible;">
                <div style="padding:20px;display:grid;gap:16px;">
                    <div>
                        <label style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.06em;display:block;margin-bottom:6px;">Client Name *</label>
                        <input id="newClientName" type="text" placeholder="e.g. Al-Fatah Enterprise" style="width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:8px;padding:9px 12px;color:var(--text);font-family:var(--font);font-size:13px;outline:none;">
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                        <div>
                            <label style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.06em;display:block;margin-bottom:6px;">Plan</label>
                            <select id="newClientPlan" style="width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:8px;padding:9px 12px;color:var(--text);font-family:var(--font);font-size:13px;outline:none;appearance:none;">
                                <option>Starter</option>
                                <option>Growth</option>
                                <option>Enterprise</option>
                                <option>Custom</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.06em;display:block;margin-bottom:6px;">Active Theme</label>
                            <select id="newClientTheme" style="width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:8px;padding:9px 12px;color:var(--text);font-family:var(--font);font-size:13px;outline:none;appearance:none;">
                                <option value="">Global Default</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.06em;display:block;margin-bottom:6px;">Contact Email</label>
                        <input id="newClientEmail" type="email" placeholder="contact@client.com" style="width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:8px;padding:9px 12px;color:var(--text);font-family:var(--font);font-size:13px;outline:none;">
                    </div>
                    <div>
                        <label style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.06em;display:block;margin-bottom:6px;">Site / Domain</label>
                        <input id="newClientSite" type="text" placeholder="client.sibyl.io" style="width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:8px;padding:9px 12px;color:var(--text);font-family:var(--font);font-size:13px;outline:none;">
                    </div>
                    <div style="display:flex;gap:10px;padding-top:4px;">
                        <button class="btn btn-primary" onclick="saveClient()">Create Client</button>
                        <button class="btn btn-ghost" onclick="showPage('clients',null)">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings -->
    <div class="page" id="page-settings">
        <div class="section-title" style="margin-bottom:20px;">Global Settings</div>
        <div style="max-width:500px;display:grid;gap:12px;">
            <div class="data-table" style="overflow:visible;">
                <div style="padding:16px 20px;border-bottom:1px solid var(--border);font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.08em;">Branding</div>
                <div style="padding:16px 20px;display:grid;gap:14px;">
                    <div>
                        <label style="font-size:11px;font-weight:600;color:var(--text2);display:block;margin-bottom:5px;">Platform Name</label>
                        <input type="text" value="Sibyl ERP" style="width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:7px;padding:8px 12px;color:var(--text);font-family:var(--font);font-size:13px;outline:none;">
                    </div>
                    <div>
                        <label style="font-size:11px;font-weight:600;color:var(--text2);display:block;margin-bottom:5px;">Support Email</label>
                        <input type="text" value="support@sibyl.io" style="width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:7px;padding:8px 12px;color:var(--text);font-family:var(--font);font-size:13px;outline:none;">
                    </div>
                    <button class="btn btn-primary" style="width:fit-content;" onclick="showToast('Settings saved','green')">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

</div><!-- /main -->
</div><!-- /app -->

<!-- Theme Assignment Modal -->
<div class="modal-overlay" id="assignModal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title">Assign Theme</div>
            <button class="modal-close" onclick="closeModal()">âœ•</button>
        </div>
        <div class="modal-body" id="assignModalBody"></div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="closeModal()">Cancel</button>
            <button class="btn btn-primary" onclick="confirmAssign()">Assign Theme</button>
        </div>
    </div>
</div>

<!-- Toast -->
<div id="toast" style="
    position:fixed;bottom:24px;right:24px;
    background:var(--bg3);border:1px solid var(--border2);
    border-radius:10px;padding:12px 18px;
    font-size:13px;font-weight:500;color:var(--text);
    box-shadow:0 8px 32px rgba(0,0,0,0.4);
    z-index:1000;opacity:0;transform:translateX(16px);
    transition:all 0.2s cubic-bezier(0.4,0,0.2,1);
    display:flex;align-items:center;gap:10px;
    pointer-events:none;
"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DATA (mocked â€” replace with Frappe API calls)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CLIENTS = [
    { id:'c1', name:'Al-Fatah Enterprise', domain:'alfatah.sibyl.io', status:'Active', plan:'Enterprise', theme:'Sibyl Dark', users:32, maxUsers:50, color:'#5B6AF0' },
    { id:'c2', name:'Metro Pharmaceuticals', domain:'metro.sibyl.io', status:'Active', plan:'Growth', theme:'Ocean Blue', users:18, maxUsers:25, color:'#0EA5E9' },
    { id:'c3', name:'Packages Limited', domain:'packages.sibyl.io', status:'Active', plan:'Enterprise', theme:'Sibyl Dark', users:45, maxUsers:100, color:'#10B981' },
    { id:'c4', name:'Artistic Milliners', domain:'am.sibyl.io', status:'Trial', plan:'Starter', theme:'', users:5, maxUsers:5, color:'#F59E0B' },
    { id:'c5', name:'Engro Corporation', domain:'engro.sibyl.io', status:'Active', plan:'Enterprise', theme:'Forest Green', users:78, maxUsers:100, color:'#8B5CF6' },
    { id:'c6', name:'Lucky Cement', domain:'lucky.sibyl.io', status:'Suspended', plan:'Growth', theme:'', users:0, maxUsers:25, color:'#F0564A' },
];

const THEMES = [
    { id:'t1', name:'Sibyl Dark', primary:'#5B6AF0', nav:'#0E1329', sidebar:'#0E1329', font:'Inter', scope:'Global', isDefault:true },
    { id:'t2', name:'Ocean Blue', primary:'#0EA5E9', nav:'#0C1A2E', sidebar:'#0C1A2E', font:'DM Sans', scope:'Global', isDefault:false },
    { id:'t3', name:'Forest Green', primary:'#10B981', nav:'#0A1F1A', sidebar:'#0A1F1A', font:'Plus Jakarta Sans', scope:'Global', isDefault:false },
    { id:'t4', name:'Midnight Purple', primary:'#8B5CF6', nav:'#120E1F', sidebar:'#120E1F', font:'Manrope', scope:'Global', isDefault:false },
    { id:'t5', name:'Sunrise Orange', primary:'#F59E0B', nav:'#1A1208', sidebar:'#1A1208', font:'Geist', scope:'Global', isDefault:false },
    { id:'t6', name:'Light Classic', primary:'#5B6AF0', nav:'#FFFFFF', sidebar:'#F8F9FC', font:'Inter', scope:'Global', isDefault:false },
];

const MODULES = ['Accounts','Selling','Buying','Stock','CRM','HR','Projects','Manufacturing'];

// Per-client module access (true = enabled)
const CLIENT_MODULES = {
    c1: { Accounts:true, Selling:true, Buying:true, Stock:true, CRM:true, HR:true, Projects:false, Manufacturing:false },
    c2: { Accounts:true, Selling:true, Buying:true, Stock:true, CRM:false, HR:true, Projects:false, Manufacturing:false },
    c3: { Accounts:true, Selling:true, Buying:true, Stock:true, CRM:true, HR:true, Projects:true, Manufacturing:true },
    c4: { Accounts:true, Selling:true, Buying:false, Stock:true, CRM:false, HR:false, Projects:false, Manufacturing:false },
    c5: { Accounts:true, Selling:true, Buying:true, Stock:true, CRM:true, HR:true, Projects:true, Manufacturing:true },
    c6: { Accounts:false, Selling:false, Buying:false, Stock:false, CRM:false, HR:false, Projects:false, Manufacturing:false },
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('clientCount').textContent = CLIENTS.filter(c=>c.status==='Active').length;
    renderDashboard();
    renderClients();
    renderThemes();
    renderModuleAccess();
    populateThemeSelect();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const pageTitles = {
    dashboard:'Dashboard', clients:'All Clients', themes:'Theme Library',
    modules:'Module Access', settings:'Settings', 'add-client':'Add Client'
};
const pageActions = {
    clients: '<button class="btn btn-primary" onclick="showPage(\'add-client\',null)">+ Add Client</button>',
    themes:  '<button class="btn btn-primary" onclick="openThemeBuilder()">+ Create Theme â†—</button>',
};

function showPage(id, navEl) {
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
    document.getElementById(`page-${id}`)?.classList.add('active');
    if(navEl) navEl.classList.add('active');
    document.getElementById('topbarTitle').textContent = pageTitles[id] || id;
    document.getElementById('topbarActions').innerHTML = pageActions[id] || '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RENDER FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDashboard() {
    const active = CLIENTS.filter(c=>c.status==='Active');
    document.getElementById('stat-clients').textContent = active.length;
    document.getElementById('stat-themes').textContent = THEMES.length;
    document.getElementById('stat-users').textContent = CLIENTS.reduce((a,c)=>a+c.users,0);
    document.getElementById('stat-enterprise').textContent = CLIENTS.filter(c=>c.plan==='Enterprise').length;

    const tbody = document.getElementById('recentClientsBody');
    tbody.innerHTML = CLIENTS.slice(0,5).map(c=>`
        <tr>
            <td>
                <div style="display:flex;align-items:center;gap:10px;">
                    <div style="width:28px;height:28px;border-radius:7px;background:${c.color};display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:#fff;flex-shrink:0;">${c.name[0]}</div>
                    <div>
                        <div style="font-weight:600;">${c.name}</div>
                        <div style="font-size:11px;color:var(--text2);">${c.domain}</div>
                    </div>
                </div>
            </td>
            <td>${statusBadge(c.status)}</td>
            <td>${planBadge(c.plan)}</td>
            <td>${c.theme ? `<span style="font-size:12px;font-weight:500;">${c.theme}</span>` : '<span style="color:var(--text3);font-size:11px;">Global Default</span>'}</td>
            <td><span style="font-family:var(--mono);font-size:12px;">${c.users}/${c.maxUsers}</span></td>
            <td>
                <div class="row-actions">
                    <button class="btn btn-ghost btn-sm" onclick="openAssignModal('${c.id}','${c.name}')">ğŸ¨ Theme</button>
                    <button class="btn btn-ghost btn-sm">âœï¸ Edit</button>
                </div>
            </td>
        </tr>
    `).join('');
}

function renderClients() {
    document.getElementById('clientGrid').innerHTML = CLIENTS.map(c=>`
        <div class="client-card">
            <div class="client-header">
                <div style="display:flex;align-items:center;gap:10px;flex:1;">
                    <div class="client-initial" style="background:${c.color};">${c.name[0]}</div>
                    <div>
                        <div class="client-name">${c.name}</div>
                        <div class="client-domain">${c.domain}</div>
                    </div>
                </div>
                ${statusBadge(c.status)}
            </div>

            <div style="display:flex;gap:6px;margin-bottom:10px;">
                ${planBadge(c.plan)}
                <span style="font-size:11px;color:var(--text2);padding:3px 0;">
                    Theme: <b style="color:var(--text);">${c.theme || 'Global Default'}</b>
                </span>
            </div>

            <div class="client-stats">
                <div class="client-stat-item">
                    <div class="client-stat-val">${c.users}</div>
                    <div class="client-stat-lbl">Users</div>
                </div>
                <div class="client-stat-item">
                    <div class="client-stat-val">${c.maxUsers}</div>
                    <div class="client-stat-lbl">Max Users</div>
                </div>
            </div>

            <div class="client-footer">
                <button class="btn btn-ghost btn-sm" style="flex:1;" onclick="openAssignModal('${c.id}','${c.name}')">ğŸ¨ Assign Theme</button>
                <button class="btn btn-ghost btn-sm" onclick="openModuleEditor('${c.id}')">ğŸ—‚ï¸ Modules</button>
            </div>
        </div>
    `).join('');
}

function renderThemes() {
    document.getElementById('themeGrid').innerHTML = THEMES.map(t=>`
        <div class="theme-card ${t.isDefault?'default':''}" onclick="selectTheme('${t.id}')">
            <div class="theme-preview-bar">
                <span style="background:${t.nav};flex:0.5;"></span>
                <span style="background:${t.sidebar};flex:0.5;"></span>
                <span style="background:${lighten(t.primary,0.85)};flex:2;"></span>
            </div>

            <div class="theme-card-body">
                <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <div style="width:32px;height:32px;border-radius:8px;background:${t.primary};flex-shrink:0;box-shadow:0 4px 12px ${t.primary}55;"></div>
                    <div>
                        <div class="theme-name">${t.name}</div>
                        <div class="theme-meta">${t.font} Â· ${t.scope}</div>
                    </div>
                </div>
                <div class="theme-swatches">
                    <div class="theme-swatch" style="background:${t.primary};" title="Primary"></div>
                    <div class="theme-swatch" style="background:${t.nav};" title="Navbar"></div>
                    <div class="theme-swatch" style="background:${t.sidebar};" title="Sidebar"></div>
                </div>
            </div>

            <div class="theme-card-footer">
                <button class="btn btn-ghost btn-sm" style="flex:1;" onclick="event.stopPropagation();openThemeBuilder('${t.id}')">âœï¸ Edit</button>
                <button class="btn btn-ghost btn-sm" style="flex:1;" onclick="event.stopPropagation();setGlobalDefault('${t.id}')">
                    ${t.isDefault?'âœ“ Default':'Set Default'}
                </button>
            </div>
        </div>
    `).join('');
}

function renderModuleAccess() {
    document.getElementById('moduleAccessBody').innerHTML = CLIENTS.map(c=>`
        <tr>
            <td>
                <div style="display:flex;align-items:center;gap:8px;">
                    <div style="width:22px;height:22px;border-radius:5px;background:${c.color};display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:800;color:#fff;">${c.name[0]}</div>
                    <span style="font-weight:600;">${c.name}</span>
                </div>
            </td>
            ${MODULES.map(m=>`
                <td style="text-align:center;">
                    <div onclick="toggleModule('${c.id}','${m}',this)" style="
                        width:22px;height:22px;border-radius:5px;
                        background:${CLIENT_MODULES[c.id]?.[m]?'var(--accent)':'rgba(255,255,255,0.06)'};
                        display:flex;align-items:center;justify-content:center;
                        cursor:pointer;transition:all 0.15s;margin:0 auto;
                        font-size:10px;color:#fff;font-weight:700;
                    ">${CLIENT_MODULES[c.id]?.[m]?'âœ“':''}</div>
                </td>
            `).join('')}
        </tr>
    `).join('');
}

function populateThemeSelect() {
    const sel = document.getElementById('newClientTheme');
    THEMES.forEach(t=>{
        const opt=document.createElement('option');
        opt.value=t.id; opt.textContent=t.name;
        sel.appendChild(opt);
    });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _assigningClientId = null;
let _selectedThemeId   = null;

function openAssignModal(clientId, clientName) {
    _assigningClientId = clientId;
    const client = CLIENTS.find(c=>c.id===clientId);
    _selectedThemeId = null;

    document.getElementById('assignModalBody').innerHTML = `
        <p style="font-size:12px;color:var(--text2);margin-bottom:14px;">
            Assigning theme to: <b style="color:var(--text);">${clientName}</b>
        </p>
        ${THEMES.map(t=>`
            <div class="theme-option ${client?.theme===t.name?'selected':''}"
                 onclick="selectAssignTheme('${t.id}',this)"
                 data-tid="${t.id}">
                <div style="width:36px;height:36px;border-radius:8px;background:${t.primary};flex-shrink:0;box-shadow:0 4px 10px ${t.primary}44;"></div>
                <div class="theme-option-info">
                    <div class="theme-option-name">${t.name}</div>
                    <div class="theme-option-meta">${t.font} Â· ${t.scope}${t.isDefault?' Â· Default':''}</div>
                </div>
                <div class="theme-option-check">${client?.theme===t.name?'âœ“':''}</div>
            </div>
        `).join('')}
    `;
    document.getElementById('assignModal').classList.add('open');
}

function selectAssignTheme(themeId, el) {
    document.querySelectorAll('.theme-option').forEach(e=>{
        e.classList.remove('selected');
        e.querySelector('.theme-option-check').textContent='';
    });
    el.classList.add('selected');
    el.querySelector('.theme-option-check').textContent='âœ“';
    _selectedThemeId = themeId;
}

function confirmAssign() {
    if (!_selectedThemeId) { showToast('Select a theme first','orange'); return; }
    const theme = THEMES.find(t=>t.id===_selectedThemeId);
    const client = CLIENTS.find(c=>c.id===_assigningClientId);
    if(client && theme) {
        client.theme = theme.name;
        renderClients();
        renderDashboard();
        showToast(`"${theme.name}" assigned to ${client.name}`,'green');
    }
    closeModal();
}

function closeModal() {
    document.getElementById('assignModal').classList.remove('open');
}

function setGlobalDefault(themeId) {
    THEMES.forEach(t=>t.isDefault=false);
    const t = THEMES.find(t=>t.id===themeId);
    if(t){ t.isDefault=true; renderThemes(); showToast(`"${t.name}" is now the global default`,'green'); }
}

function selectTheme(themeId) {}

function openThemeBuilder(themeId) {
    // In Frappe: frappe.set_route('sibyl-theme-builder')
    // Standalone: open the builder page
    showToast('Opening Theme Builder...','blue');
    setTimeout(()=>window.open('sibyl-theme-builder.html','_blank'),300);
}

function openModuleEditor(clientId) {
    showPage('modules', null);
}

function toggleModule(clientId, module, el) {
    if(!CLIENT_MODULES[clientId]) CLIENT_MODULES[clientId]={};
    CLIENT_MODULES[clientId][module] = !CLIENT_MODULES[clientId][module];
    const on = CLIENT_MODULES[clientId][module];
    el.style.background = on?'var(--accent)':'rgba(255,255,255,0.06)';
    el.textContent = on?'âœ“':'';
    showToast(`${module} ${on?'enabled':'disabled'}`,'blue',1.5);
}

function saveClient() {
    const name = document.getElementById('newClientName').value.trim();
    if(!name){showToast('Enter a client name','orange');return;}
    const colors=['#5B6AF0','#0EA5E9','#10B981','#8B5CF6','#F59E0B','#F0564A'];
    CLIENTS.push({
        id:`c${Date.now()}`,name,
        domain:document.getElementById('newClientSite').value||`${name.toLowerCase().replace(/\s+/g,'-')}.sibyl.io`,
        status:'Trial',
        plan:document.getElementById('newClientPlan').value,
        theme:'',users:0,maxUsers:5,
        color:colors[Math.floor(Math.random()*colors.length)]
    });
    renderClients();renderDashboard();
    document.getElementById('clientCount').textContent=CLIENTS.filter(c=>c.status==='Active').length;
    showToast(`Client "${name}" created`,'green');
    showPage('clients',null);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function statusBadge(s){
    const m={Active:'badge-green',Trial:'badge-blue',Suspended:'badge-red',Inactive:'badge-gray'};
    return `<span class="badge ${m[s]||'badge-gray'}">${s}</span>`;
}
function planBadge(p){
    const m={Enterprise:'badge-purple',Growth:'badge-blue',Starter:'badge-gray',Custom:'badge-yellow'};
    return `<span class="badge ${m[p]||'badge-gray'}">${p}</span>`;
}
function lighten(hex,amt){
    let r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);
    r=Math.round(r+(255-r)*amt);g=Math.round(g+(255-g)*amt);b=Math.round(b+(255-b)*amt);
    return `rgb(${r},${g},${b})`;
}

function showToast(msg,type='blue',dur=3){
    const t=document.getElementById('toast');
    const icons={blue:'â„¹',green:'âœ“',orange:'âš ',red:'âœ•'};
    t.innerHTML=`<span>${icons[type]||'â„¹'}</span><span>${msg}</span>`;
    const cols={blue:'#5B6AF0',green:'var(--green)',orange:'var(--yellow)',red:'var(--red)'};
    t.style.borderLeft=`4px solid ${cols[type]||cols.blue}`;
    t.style.opacity='1';t.style.transform='translateX(0)';t.style.pointerEvents='auto';
    clearTimeout(t._timer);
    t._timer=setTimeout(()=>{t.style.opacity='0';t.style.transform='translateX(16px)';t.style.pointerEvents='none';},dur*1000);
}
</script>
</body>
</html>
